# =====  ANSIBLE  ============================================================
#          NAME:  tasks/deploy-files.yml
#   DESCRIPTION:  Primary entry point for this play
# =============================================================================
---
- name: Remove any existing configuration directories
  ansible.builtin.file:
    path: "{{ user_home_dir }}/.config/{{ rm_config_item }}"
    state: "absent"
  loop:
    - "environment.d"
    - "git"
    - "gnupg"
    - "systemd"
    - "tmux"
  loop_control:
    loop_var: "rm_config_item"

- name: Create links in home directory to config files
  ansible.builtin.file:
    src: "{{ install_dotfiles_base_path }}/config/{{ ln_config_item }}"
    dest: "{{ user_home_dir }}/.config/{{ ln_config_item }}"
    state: "link"
    owner: "{{ ansible_user_id }}"
    group: "{{ ansible_user_gid }}"
  loop:
    - "environment.d"
    - "git"
    - "gnupg"
    - "systemd"
    - "tmux"
  loop_control:
    loop_var: "ln_config_item"
  notify:
    - reload-user-systemd
